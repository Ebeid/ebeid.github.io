
<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta http-equiv="X-UA-Compatible" content="ie=edge"/>
<meta name="theme-color" content="#478079" >



<title>Ebeid ElSayed | Product Manager</title>
<meta name="description" content='Ebeid ElSayed | Product Manager | Personal Site.'>


<style data-generator="critical-css">

</style>



    
        
        
    

    
        
        
    

    
        
        
    

  
  
  
  
  <link rel="stylesheet" href="http://localhost:1313/css/menu.6e233ea8020133c8fdf840fc9876a529cacbe674c7d8193cc12963d7eb29f253.css" integrity="sha256-biM&#43;qAIBM8j9&#43;ED8mHalKcrL5nTH2Bk8wSlj1&#43;sp8lM=">







 


<link
  rel="preload"
  href="/css/bundle.css"
  as="style"
  data-generator="purgeCSS"
  onload="this.onload=null;this.rel='stylesheet'"
  
/>
<noscript>
  <link 
    rel="stylesheet" 
    href="/css/bundle.css"
    
  />
</noscript>



<script src='http://localhost:1313/js/library/lozad.min.js'></script>

 

  </head>

  <body>
    

<header class="header fixed-top rad-animation-group" id="header">
  <div class="container rad-fade-in">
    <nav class="navbar navbar-expand-lg navbar-light p-0">
      <div class="container-fluid">
        <a class="navbar-brand mx-auto" href="http://localhost:1313/">
          <span>Ebeid</span>
          <span>ElSayed</span>
        </a>
        <button
          class="navbar-toggler collapsed"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent, #header"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-lg-auto">
            <li class="nav-item">
              <a class="nav-link active" href="http://localhost:1313/">HOME</a>
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="/#about"
                >ABOUT</a
              >
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="/#experience"
                >EXPERIENCE</a
              >
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="/blog"
                >BLOG</a
              >
            </li>
            
            <li class="nav-item">
              <a data-scroll class="nav-link" href="/#contact"
                >CONTACT</a
              >
            </li>
            
          </ul>
        </div>
      </div>
    </nav>
  </div>
</header>


<section id="breadcrumb-bar" class="breadcrumb-bar container">
        <ul class="breadcrumbs">
            <li class="breadcrum-item"><span><a href="/">Home</a></span></li><li class="breadcrum-item"><span><a href="/2011">2011th</a></span></li><li class="breadcrum-item"><span><a href="/2011/11">11th</a></span></li><li class="breadcrum-item"><span><a href="/2011/11/introduction-to-microsoft-message.html">Introduction to microsoft message.html</a></span></li></ul>
</section>


    <section
      id="blog-single"
      class="section section--border-bottom rad-animation-group"
    >
      <div class="container">
        <h1><a href="/2011/11/introduction-to-microsoft-message.html">An introduction to Microsoft Message Queuing</a></h1>

        <aside id="meta" class="light-border-bottom">
          <div>
            <section>
              Published en
              <h4 id="date">Thu Nov 17, 2011</h4>
              ¬∑
              <h4 id="wordcount">1030 Words</h4>
            </section>
             
            <ul id="tags">
              
              <li><a href="/tags/msmq/">MSMQ</a></li>
              
            </ul>
            
          </div>
        </aside>

        <div class="row flex-column-reverse flex-md-row rad-fade-down">
          <div class="col-12"><p><strong>What is MSMQ ?</strong> Message Queuing (also known as MSMQ) is a messaging infrastructure and a development tool for creating distributed messaging applications for Microsoft Windows operating systems. Applications developed for Message Queuing send messages to queues, which are temporary storage locations, from which messages can proceed to their final destination as conditions permit.</p>
<p><strong>Installing MSMQ</strong> The procedures to install MSMQ on Windows Server 2008, Winows Server 2008 R2, Windows 7, Windows Vista, Windows XP, and Windows Server 2003 are available <a href="http://msdn.microsoft.com/en-us/library/aa967729.aspx" title="Installing Message Queuing (MSMQ)">here</a></p>
<p><strong>Basic Messaging</strong></p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg76CH-nuXKWwyD1_utV7oYfPINRNUXKtfr-jiRilt7REJwCh5RaUKdBk2L8KyHzqxr5y71wQapJaSdAsEThtw-VZW_DOhygCp5WDwqSKrc2hxLPSBZwqeBU0l9n7LGgvxc-LNJXy4vig/s1600-h/MSMQ1%25255B3%25255D.jpg"><img alt="MSMQ1" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjtsZangRkoBX-eDdtPj1yYYPJyO0Q5gEnxE6-8kJDt_6WDMW0Mdb6UEJ04v7S8vnt0UbCsb1qgfwq_zqHc83SkpNN_i-3nsfwzeb1JzKnRjKWPXOQpo5N-DjfuGgpOH_X5H6b2jDU4Xw/?imgmax=800" title="MSMQ1"></a></p>
<p>The image shows the basic messaging scenario. You have two applications: a sending application and a receiving application. A sending application prepares a message and puts it into a queue. A message can be any piece of information that the receiving application understands. The receiving application receives the message from the queue and processes it. One thing to note here is that the sender and the receiver are not tightly coupled and they can work without the other application being online.</p>
<p><strong>Messaging in .Net</strong> To build a messaging application we need to create at least three components: queue, application to send messages, and another application to receive these messages.</p>
<p><strong>Types of queues</strong> The basic types of MSMQ queues are: private and public. Public queues are those that are published in the active directory. So, applications running on different servers throughout the network can find and use public queues through the active directory. Private queues on the other hand are available locally on a particular machine and are not published in the active directory.</p>
<p><strong>Creating a Queue</strong> Queues can be created either programmatically or through the computer management snap-in (if you installed MSMQ on your machine).</p>
<ul>
<li><strong>Programmatically</strong> The System.Messaging.M<code>essageQueue</code> class provides all the necessary functionality to work with and manipulate MSMQ queues. It is like a wrapper around message queuing. MessageQueue.Create(path) creates a non-transactional message queue at the specified path (we will talk about transactional and non-transactional queues later). For public queues, path is MachineName\QueueName. For private queues, MachineName\Private$\QueueName. You can use &ldquo;.&rdquo; for the local computer. Code should look like:</li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode, .csharpcode pre<!-- raw HTML omitted -->{<!-- raw HTML omitted --> font-size: small;<!-- raw HTML omitted --> color: black;<!-- raw HTML omitted --> font-family: consolas, &ldquo;Courier New&rdquo;, courier, monospace;<!-- raw HTML omitted --> background-color: #ffffff;<!-- raw HTML omitted --> /*white-space: pre;*/<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode pre { margin: 0em; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .rem { color: #008000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .kwrd { color: #0000ff; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .str { color: #006080; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .op { color: #0000c0; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .preproc { color: #cc6633; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .asp { background-color: #ffff00; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .html { color: #800000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .attr { color: #ff0000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .alt <!-- raw HTML omitted -->{<!-- raw HTML omitted --> background-color: #f4f4f4;<!-- raw HTML omitted --> width: 100%;<!-- raw HTML omitted --> margin: 0em;<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .lnum { color: #606060; }</p>
<pre tabindex="0"><code>MessageQueue privateQueue = MessageQueue.Create(&#34;.\\\\Private$\\\\privateQueue&#34;); 
</code></pre><ul>
<li><strong>Through the computer management snap-in</strong> Open the computer management snap-in (right click computer, then manage). Navigate to Services and Applications, then Message Queuing. Right click on Private Queues ‚Äì&gt; New ‚Äì&gt; Private Queue. Or right click on public Queues ‚Äì&gt; New ‚Äì&gt; Public Queue.</li>
</ul>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhVOcdr9tah6U-isQcBIsWlNvDhNXeJCSQqapghmndEHkCR6LwlX_mf4rkGawc7bEBW5WW1SpPlf6GaxYta6YE2hnNkq_A8AXcoKxIQqvgx6We2Z0e1r6Abwbpgjq0tKyroqec69nsoVw/s1600-h/MMC%25255B5%25255D.jpg"><img alt="MMC" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh2J_yCT1UmHH1egrrDkVA9R_a3sDNSNkgsecB7z_d9lAYbY9Ol_3tq0dlsPURKLeKFbWhgnGhnoNIFIfup-L6zUIdo3svfBn0lBCJCNSAOrIUJnj8qy5WL8R4w6ZL9DAvqbO9VxAe0vg/?imgmax=800" title="MMC"></a></p>
<p><strong>Sending a message</strong> Use Send() method of your previously created MessageQueue object like so</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode, .csharpcode pre<!-- raw HTML omitted -->{<!-- raw HTML omitted --> font-size: small;<!-- raw HTML omitted --> color: black;<!-- raw HTML omitted --> font-family: consolas, &ldquo;Courier New&rdquo;, courier, monospace;<!-- raw HTML omitted --> background-color: #ffffff;<!-- raw HTML omitted --> /*white-space: pre;*/<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode pre { margin: 0em; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .rem { color: #008000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .kwrd { color: #0000ff; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .str { color: #006080; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .op { color: #0000c0; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .preproc { color: #cc6633; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .asp { background-color: #ffff00; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .html { color: #800000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .attr { color: #ff0000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .alt <!-- raw HTML omitted -->{<!-- raw HTML omitted --> background-color: #f4f4f4;<!-- raw HTML omitted --> width: 100%;<!-- raw HTML omitted --> margin: 0em;<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .lnum { color: #606060; }</p>
<pre tabindex="0"><code>privateQueue.Send(&#34;Message Body (could be any managed object)&#34;, &#34;Message Label&#34;);
</code></pre><p><strong>Receiving a message</strong> There are two types of operations with respect to reading a message fom the Queue: Peeking and Receiving. When we receive a message from the queue, the message is removed from the queue. Peeking is similar to Receiving but here the message is not removed from the queue. Code could look like</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode, .csharpcode pre<!-- raw HTML omitted -->{<!-- raw HTML omitted --> font-size: small;<!-- raw HTML omitted --> color: black;<!-- raw HTML omitted --> font-family: consolas, &ldquo;Courier New&rdquo;, courier, monospace;<!-- raw HTML omitted --> background-color: #ffffff;<!-- raw HTML omitted --> /*white-space: pre;*/<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode pre { margin: 0em; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .rem { color: #008000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .kwrd { color: #0000ff; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .str { color: #006080; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .op { color: #0000c0; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .preproc { color: #cc6633; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .asp { background-color: #ffff00; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .html { color: #800000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .attr { color: #ff0000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .alt <!-- raw HTML omitted -->{<!-- raw HTML omitted --> background-color: #f4f4f4;<!-- raw HTML omitted --> width: 100%;<!-- raw HTML omitted --> margin: 0em;<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .lnum { color: #606060; }</p>
<pre tabindex="0"><code>MessageQueue anotherPrivateQueue = new MessageQueue(&#34;.\\\\Private$\\\\privateQueue&#34;);
</code></pre><pre tabindex="0"><code>System.Messaging.Message msg = anotherPrivateQueue.Receive();
</code></pre><p><strong>Additional Considerations</strong> before writing the first complete messaging application</p>
<ul>
<li>
<p>You have to check if there is already a Message Queuing queue with the same name before creating your new queue. Use MessageQueue.Exists(path) to check for queue existence.</p>
</li>
<li>
<p>When receiving a message and before accessing its body, you have to set the Formatter property of the Message object. There is a lot of built-in formatters. For now, we can use XMLFormatter.</p>
</li>
</ul>
<p>Now, let‚Äôs get things together into a ‚ÄúHello, World‚Äù example. Open Visual Studio, New project, Windows forms. All reference to System.Messaging namespace. Then edit your code to look like so:</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode, .csharpcode pre<!-- raw HTML omitted -->{<!-- raw HTML omitted --> font-size: small;<!-- raw HTML omitted --> color: black;<!-- raw HTML omitted --> font-family: consolas, &ldquo;Courier New&rdquo;, courier, monospace;<!-- raw HTML omitted --> background-color: #ffffff;<!-- raw HTML omitted --> /*white-space: pre;*/<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode pre { margin: 0em; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .rem { color: #008000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .kwrd { color: #0000ff; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .str { color: #006080; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .op { color: #0000c0; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .preproc { color: #cc6633; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .asp { background-color: #ffff00; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .html { color: #800000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .attr { color: #ff0000; }<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .alt <!-- raw HTML omitted -->{<!-- raw HTML omitted --> background-color: #f4f4f4;<!-- raw HTML omitted --> width: 100%;<!-- raw HTML omitted --> margin: 0em;<!-- raw HTML omitted -->}<!-- raw HTML omitted --><!-- raw HTML omitted -->.csharpcode .lnum { color: #606060; }</p>
<pre tabindex="0"><code>  
  
using System;
  
using System.Collections.Generic;
  
using System.Linq;
  
using System.Text;
  
using System.Messaging;
  
  
namespace MSMQ\_Demo
  
{
  
    class Program
  
    {
  
        static void Main(string\[\] args)
  
        {
  
            try
  
            {
  
                MessageQueue privateQueue;
  
                if (!MessageQueue.Exists(&#34;.\\\\Private$\\\\privateQueue&#34;))
  
                    privateQueue = MessageQueue.Create(&#34;.\\\\Private$\\\\privateQueue&#34;);
  
                else
  
                    privateQueue = new MessageQueue(&#34;.\\\\Private$\\\\privateQueue&#34;);
  
  
                privateQueue.Send(&#34;Hello, World !&#34;, &#34;Message Label&#34;);
  
                MessageQueue anotherPrivateQueue = new MessageQueue(&#34;.\\\\Private$\\\\privateQueue&#34;);
  
                System.Messaging.Message msg = anotherPrivateQueue.Receive();
  
                msg.Formatter = new System.Messaging.XmlMessageFormatter(new Type\[1\] { typeof(string) });
  
                Console.WriteLine(msg.Body.ToString());
  
            }
  
            catch (Exception ex)
  
            {
  
                Console.WriteLine(ex.Message);
  
            }
  
        }
  
    }
  
}
  
  
</code></pre><p>If you run the project, you will see a message-box displaying ‚ÄúHello, World !‚Äù. This message content created by had been sent from MSMQ queue, received by another MSMQ, and processed. In our example both the sending and the receiving queues exist in the same application for the sake of simplicity. In real world applications they reside in very different areas.</p>
<p>This is a very basic introduction to MSMQ and non-transactional queues. In future posts, we will explore more advanced topics in MSMQ.</p>
</div>
        </div>

        <aside class="content-browser light-border-top">
            Continue reading
            <div>
                
                    <a class="previous" href="/blog/an-introduction-to-jquery/">‚Ü© An introduction to jQuery</a>
                
                 ‚ñ† 
                
                    <a class="next" href="/2011/11/in-previous-post-we-explored-very-basic.html"> An introduction to Microsoft Message Queuing‚ÄìPart 2 ‚Ü™</a>
                
            </div>
        </aside>
      </div>
    </section>

    <footer class="footer">
  <div class="container">
    <div class="footer__left">
      <div class="footer__copy">
        <a href="https://themes.gohugo.io/themes/adritian-free-hugo-theme">¬© Adritian</a>. Free Hugo theme by <a href="https://www.adrianmoreno.info">Adri√°n Moreno Pe√±a</a>.</br><a href="https://github.com/Ebeid/ebeid.github.io">Site content and code available in GitHub</a>.
      </div>
    </div>
    <div class="footer__links">
      <ul class="navbar-nav ">
        <li class="nav-item">
            <a class="nav-link" href="http://localhost:1313/">üè† HOME</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="/#about">ABOUT</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link" href="/#contact">CONTACT</a>
        </li>
        
      </ul>
    </div>
    <div class="footer__right">
      
    </div>
  </div>
</footer>
 <script>
  window.addEventListener("load", function() {
    try{
      var observer = window.lozad(".lozad", {
        rootMargin: window.innerHeight / 2 + "px 0px",
        threshold: 0.01
      }); 
      observer.observe();
    } catch(e) {
      console.error(e);
    }
  });
</script>
<script defer src='http://localhost:1313/js/rad-animations.js'></script>
<script defer src='http://localhost:1313/js/library/smooth-scroll.polyfills.min.js'></script>
<script defer src='http://localhost:1313/js/sticky-header.js'></script>
<script defer src='http://localhost:1313/js/smooth-scroll-init.js'></script>
<script defer src='http://localhost:1313/js/library/bootstrap.min.js'></script>





<script>
  window.si = window.si || function () { (window.siq = window.siq || []).push(arguments); };
</script>



  </body>
</html>


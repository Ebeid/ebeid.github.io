---
title: 'Python Notes – 9 : Serialization'
date: '2009-03-27T01:53:00.001-05:00'

tags:
- Python
modified_time: '2009-05-15T01:50:04.566-05:00'
blogger_id: tag:blogger.com,1999:blog-59384554657271185.post-4108398750179200674
blogger_orig_url: http://ebeid-soliman.blogspot.com/2009/03/python-notes-9.html
---

<p>Welcome to our ninth note in our Python learning process. We talked previously about files and how to handle it but we talked about writing and reading only the primitive data types as integers and strings. We also talked about objects and classes. Now, what if we want to write a compound data type or a complex object to a file. This note will talk about writing objects to files, which is called object serialization.</p>  <h4>pickle</h4>  <p>The pickle module is a Python built-in module that object serialization and de-serialization. To store a data structure, use the dump method and then close the file in the usual way:</p>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; pickle.dump(12.3, f)</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; pickle.dump([1,2,3], f)</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; f.close()</font></p> </blockquote>  <p>Then we can open the file for reading and load the data structures we dumped:</p>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; f = open(&quot;test.pck&quot;,&quot;r&quot;)</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; x = pickle.load(f)</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; x</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">12.3</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; type(x)</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&lt;type 'float'&gt;</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; y = pickle.load(f)</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; y</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">[1, 2, 3]</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&gt;&gt;&gt; type(y)</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">&lt;type 'list'&gt;</font></p> </blockquote>  <p>Each time we invoke load, we get a single value from the file, complete with its original type.</p>  <h4>What can be serialized and de-serialized</h4>  <p>The following types can be serialized and de-serialized using pickle:</p>  <ul>   <li>None, True, and False </li>    <li>integers, long integers, floating point numbers, complex numbers </li>    <li>normal and Unicode strings </li>    <li>tuples, lists, sets, and dictionaries containing only picklable objects </li>    <li>functions defined at the top level of a module </li>    <li>built-in functions defined at the top level of a module </li>    <li>classes that are defined at the top level of a module </li>    <li>instances of such classes whose__dict__ or __setstate__() is picklable </li> </ul>  <h4>Things to consider when using pickle</h4>  <ul>   <li>Attempts to pickle unpicklable objects will raise the picklingError exception; when this happens, an unspecified number of bytes may have already been written to the underlying file. </li>    <li>Trying to pickle a highly recursive data structure may exceed the maximum recursion depth, a RuntimeError will be raised in this case. You can carefully raise this limit with sys.setrecursionlimit(). </li> </ul>  <h4>cPickle</h4>  <p>The cPickle is an optimized version of pickle written in C, so it can be up to 1000 faster than pickle.</p>  <h4>marshal</h4>  <p>The marshal module can also be used for serialization. Marshal is similar to pickle, but is intended only for simple objects. Can’t handle recursion or class instances. On the plus side, it’s pretty fast if you just want to save simple objects to a file. Data is stored in a binary architecture independent format.To serialize:</p>  <blockquote>   <p><font color="#0000ff">import marshal</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">marshal.dump(obj,file)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Write obj to file</font></p> </blockquote>  <p>To unserialize:</p>  <blockquote>   <p><font color="#0000ff">obj = marshal.load(file)</font>
</p> </blockquote>  <h4>shelve</h4>  <p>The shelve module provides a persistent dictionary. It is works like a dictionary, but data is stored on disk. </p>  <p>Keys must be strings. Data can be any object serializable with pickle.</p>  <blockquote>   <p><font color="#0000ff">import shelve</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">d = shelve.open(&quot;data&quot;) # Open a ’shelf’</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">d[’foo’] = 42 # Save data</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">x = d[’bar’] # Retrieve data</font></p> </blockquote>  <h4>Shelf operations</h4>  <blockquote>   <p><font color="#0000ff">d[key] = obj&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Store an object</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">obj = d[key]&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Retrieve an object</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">del d[key]&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Delete an object</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">d.has_key(key)&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Test for existence of key</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">d.keys()&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Return a list of all keys</font></p> </blockquote>  <blockquote>   <p><font color="#0000ff">d.close()&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; # Close the shelf</font></p> </blockquote>  <p>In this note will talked about writing objects to files, which is called object serialization. Object serialization is very useful in persisting your application logic to resume its execution later, transfer of execution to remote machine, and many other applications scenarios.</p>

---
layout: post
title: Using Python Scripts with IIS 7
date: '2009-08-15T00:31:00.001-05:00'
author: Ebeid Soliman ElSayed
tags:
- Python
modified_time: '2009-08-15T00:34:50.715-05:00'
thumbnail: http://lh4.ggpht.com/_R1exOFT_lVs/SoZHuXw03LI/AAAAAAAAAFk/K1DABd0FU6M/s72-c/Screenshot%20Studio%20capture%20%231_thumb%5B3%5D.jpg?imgmax=800
blogger_id: tag:blogger.com,1999:blog-59384554657271185.post-2403505418848381278
blogger_orig_url: http://ebeid-soliman.blogspot.com/2009/08/using-python-scripts-with-iis-7.html
---

<p>Here are the steps you should make if you want to use python scripts on IIS 7:</p>  <ul>   <li>Please make sure Python is installed properly or refer to <a href="http://ebeid-soliman.blogspot.com/2009/03/python-notes-1.html" target="_blank">Python Notes – 1 : Setup</a> for installation steps.</li>    <li>Make sure CGI module is installed in IIS 7. </li> </ul>  <p><strong>Control Panel</strong> -&gt; <strong>Programs</strong> -&gt; <strong>Program and Features</strong> -&gt; <strong>Turn Windows features on and off</strong> -&gt; <strong>Internet Information Services</strong> -&gt; <strong>World Wide Web Services</strong> -&gt; <strong>Application Development Features</strong> -&gt; <strong>CGI module </strong>(Ensure that it is selected).</p>  <blockquote>   <p><a href="http://lh5.ggpht.com/_R1exOFT_lVs/SoZHsToFdQI/AAAAAAAAAFg/lNjCD_Z3qnI/s1600-h/Screenshot%20Studio%20capture%20%231%5B5%5D.jpg"><img title="Screenshot Studio capture #1" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="425" alt="Screenshot Studio capture #1" src="http://lh4.ggpht.com/_R1exOFT_lVs/SoZHuXw03LI/AAAAAAAAAFk/K1DABd0FU6M/Screenshot%20Studio%20capture%20%231_thumb%5B3%5D.jpg?imgmax=800" width="362" border="0" /></a> </p> </blockquote>  <ul>   <li>Add web application for Python, In IIS Manager, right click <strong>Sites</strong> –&gt; <strong>Add Web Site..</strong></li> </ul>  <blockquote>   <p><a href="http://lh5.ggpht.com/_R1exOFT_lVs/SoZHzBoygmI/AAAAAAAAAE4/Rw7jkbRy-kM/s1600-h/Screenshot%20Studio%20capture%20%232%5B3%5D.jpg"><img title="Screenshot Studio capture #2" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="240" alt="Screenshot Studio capture #2" src="http://lh4.ggpht.com/_R1exOFT_lVs/SoZH1C71TqI/AAAAAAAAAE8/pBjhfzy6APw/Screenshot%20Studio%20capture%20%232_thumb%5B1%5D.jpg?imgmax=800" width="242" border="0" /></a> </p> </blockquote>  <ul>   <li>In the <strong>Add Web Site</strong> dialog box, set <strong>Site name </strong>e.g.: PythonTest, and make it pointing to some folder like C:\PythonTest, then click <strong>OK</strong></li> </ul>  <blockquote>   <p><a href="http://lh6.ggpht.com/_R1exOFT_lVs/SoZH3Cw_GFI/AAAAAAAAAFw/1t7xc7r9ktA/s1600-h/Screenshot%20Studio%20capture%20%234%5B4%5D.jpg"><img title="Screenshot Studio capture #4" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="446" alt="Screenshot Studio capture #4" src="http://lh6.ggpht.com/_R1exOFT_lVs/SoZH54qE0pI/AAAAAAAAAF4/ms6ART8wQGM/Screenshot%20Studio%20capture%20%234_thumb%5B2%5D.jpg?imgmax=800" width="461" border="0" /></a> </p> </blockquote>  <ul>   <li>In <strong>Features View</strong>, open <strong>Handler Mappings</strong></li> </ul>  <blockquote>   <p><a href="http://lh6.ggpht.com/_R1exOFT_lVs/SoZH7iHBHQI/AAAAAAAAAGA/cbowuq2B8bg/s1600-h/Screenshot%20Studio%20capture%20%235%5B6%5D.jpg"><img title="Screenshot Studio capture #5" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="381" alt="Screenshot Studio capture #5" src="http://lh6.ggpht.com/_R1exOFT_lVs/SoZH-VDW9TI/AAAAAAAAAGI/aRzXPDOXwS8/Screenshot%20Studio%20capture%20%235_thumb%5B4%5D.jpg?imgmax=800" width="563" border="0" /></a> </p> </blockquote>  <ul>   <li>On the left pane click <strong>Add Script Map ...</strong></li> </ul>  <blockquote>   <p><a href="http://lh5.ggpht.com/_R1exOFT_lVs/SoZIArQsLjI/AAAAAAAAAGQ/E5u9nOTSKqA/s1600-h/Screenshot%20Studio%20capture%20%237%5B4%5D.jpg"><img title="Screenshot Studio capture #7" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="237" alt="Screenshot Studio capture #7" src="http://lh4.ggpht.com/_R1exOFT_lVs/SoZIC_AiACI/AAAAAAAAAGU/CPKVDH-QLRs/Screenshot%20Studio%20capture%20%237_thumb%5B2%5D.jpg?imgmax=800" width="295" border="0" /></a> </p> </blockquote>  <ul>   <li>In <strong>Request</strong> path, put &quot;*.py&quot; as the script files extension, In <strong>Executable</strong> select &quot;C:\Python25\Python.exe %s %s&quot;, or change it according to your Python installation path. (The two &quot;%s&quot; after the executable are required for console-based script interpreters but would not be required for an Internet Server API [ISAPI]-based script interpreter). Then give the script mapping an appropriate Name, like Python. Click <strong>OK</strong>.</li> </ul>  <blockquote>   <p><a href="http://lh5.ggpht.com/_R1exOFT_lVs/SoZIEUnp4NI/AAAAAAAAAFY/Ua1obD_qe24/s1600-h/Screenshot%20Studio%20capture%20%238%5B3%5D.jpg"><img title="Screenshot Studio capture #8" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="369" alt="Screenshot Studio capture #8" src="http://lh3.ggpht.com/_R1exOFT_lVs/SoZIFyPZSVI/AAAAAAAAAFc/qzJr3U5nlJY/Screenshot%20Studio%20capture%20%238_thumb%5B1%5D.jpg?imgmax=800" width="452" border="0" /></a> </p> </blockquote>  <ul>   <li>Create a test.py into the virtual directory (C:\PythonTest), and copy the following script into it.</li> </ul>  <blockquote>   <p>print </p>    <p>print 'Status: 200 OK' </p>    <p>print 'Content-type: text/html' </p>    <p>print </p>    <p>print '&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;Python Sample CGI&lt;/TITLE&gt;&lt;/HEAD&gt;' print '&lt;BODY&gt;' </p>    <p>print '&lt;H1&gt;This is a header&lt;/H1&gt;' </p>    <p>print '&lt;p&gt;' #this is a comment </p>    <p>print 'See this is just like most other HTML' </p>    <p>print '&lt;br&gt;' </p>    <p>print '&lt;/BODY&gt;'</p> </blockquote>  <ul>   <li>Then type <a title="http://localhost/pythontest/test.py" href="http://localhost/pythontest/test.py">http://localhost/pythontest/test.py</a> into your IE URL bar to verify it is working.</li> </ul>  
---
title: "Redis 101– Part 2"
date: '2013-07-03T12:47:00.000-05:00'

tags:
- Redis
- NoSQL
modified_time: '2013-07-03T12:47:00.801-05:00'
thumbnail: http://lh6.ggpht.com/-tq9NotXnyqU/UdMSJ6tzziI/AAAAAAAABoM/wX3ia6DrS9k/s72-c/Redis%252520Client_2013-07-01_16-25-11_thumb%25255B1%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-59384554657271185.post-3420317279598115747
blogger_orig_url: http://ebeid-soliman.blogspot.com/2013/07/redis-101-part-2.html
---

<p>We introduced many of the <a title="Redis" href="http://redis.io/" target="_blank">Redis</a>’s fundamental concepts and commands in the last post. In this post we going to introduce some advanced features.</p> <h4>Publish-Subscribe</h4> <p>Previously we queued data that could be read by a blocking pop command. Using that queue, we made a very basic publish-subscribe model. Any number of messages could be pushed to this queue, and a single queue reader would pop messages as they were available. This is powerful but limited. Redis provides some specialized publish-subscribe (or pub-sub) commands.</p> <ul> <li><strong>SUBSCRIBE</strong> subscribe a client to a key, known as a channel in pub-sub terminology; client will block until messages are available.</li></ul> <p><a href="http://lh5.ggpht.com/-OQmPeb9nXDw/UdMSI39yu4I/AAAAAAAABoE/f6ZtB-tKFcI/s1600-h/Redis%252520Client_2013-07-01_16-25-11%25255B3%25255D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="Redis Client_2013-07-01_16-25-11" border="0" alt="Redis Client_2013-07-01_16-25-11" src="http://lh6.ggpht.com/-tq9NotXnyqU/UdMSJ6tzziI/AAAAAAAABoM/wX3ia6DrS9k/Redis%252520Client_2013-07-01_16-25-11_thumb%25255B1%25255D.png?imgmax=800" width="393" height="87"></a></p> <ul> <li><strong>PUBLISH</strong> will push message into the channel returning how many subscribers have received it</li> <ul> <li>Publisher window <a href="http://lh4.ggpht.com/-MllJeVI0lUo/UdMSKhNqh4I/AAAAAAAABoU/XoYUIVVhJQk/s1600-h/Redis%252520Client_2013-07-01_16-27-41%25255B5%25255D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="Redis Client_2013-07-01_16-27-41" border="0" alt="Redis Client_2013-07-01_16-27-41" src="http://lh4.ggpht.com/-VzxScjAR26c/UdMSLjwihGI/AAAAAAAABoc/P78eZwyvUBU/Redis%252520Client_2013-07-01_16-27-41_thumb%25255B3%25255D.png?imgmax=800" width="374" height="68"></a></li> <li>Subscriber window receives : the string “message”, the channel name, the published message value <a href="http://lh3.ggpht.com/-C5wonBQou-M/UdMSMZlSS8I/AAAAAAAABok/nt53yVvAZrU/s1600-h/Redis%252520Client_2013-07-01_16-28-53%25255B5%25255D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="Redis Client_2013-07-01_16-28-53" border="0" alt="Redis Client_2013-07-01_16-28-53" src="http://lh3.ggpht.com/-d8H53tQMQtg/UdMSNNgLKgI/AAAAAAAABos/iLljTq0IFeM/Redis%252520Client_2013-07-01_16-28-53_thumb%25255B3%25255D.png?imgmax=800" width="324" height="136"></a></li></ul> <li>UNSUBSCRIBE unsubscribe or disconnect from the specified channel. If no channel name provided, it will disconnect from all channels.</li></ul> <h4>Server Information</h4> <ul> <li><strong>INFO</strong> returns a list of server data, including version, process ID, memory used, and uptime.</li></ul>   <p>In order to change any of the Redis’s default configurations, you need to edit redis.config file at C:\Program Files\Redis\conf . It is fairly self-explanatory.</p> <h4>Durability</h4> <p>Redis has a few persistence options:</p> <ul> <li>No persistence at all, which simply keeps all values in main memory.</li> <li>Forced save</li> <ul> <li>Use command <strong>SAVE</strong> to force server to save database to disk.</li> <li>Use command <strong>BGSAVE</strong> to force server to save database to disk asynchronously in the background.</li> <li>Use command <strong>LASTSAVE</strong> to get a timestamp of the last time a Redis disk write succeeded (also provided through the <em>last_save_time</em> field in the server <strong>INFO</strong> output).</li></ul></ul> <h4>Snapshotting</h4> <p>By default Redis saves snapshots of the dataset on disk, in a binary file called dump.rdb. You can configure Redis to have it save the da
taset every N seconds if there are at least M changes in the dataset, or you can manually force it by calling the SAVE or BGSAVE commands as we said before. For example, the following configuration will make Redis automatically dump the dataset to disk every 60 seconds if at least 1000 keys changed (This strategy is known as <i>snapshotting</i>.): <p><font color="#0000ff">save 60 1000</font>&nbsp; <h4>&nbsp;</h4> <h4>Append-only file</h4> <p>Snapshotting is not very durable. If your computer running Redis stops, the latest data written on Redis will get lost. While this may not be a big deal for some applications, there are use cases for full durability, and in these cases Redis was not a viable option. <p>The <i>append-only file</i> is an alternative, fully-durable strategy for Redis. It became available in version 1.1. You can turn on the AOF in your configuration file: <p><font color="#0000ff">appendonly yes</font> <p>Then we must decide how often a command is appended to the file. Setting <em>always</em> is the more durable, since every command is saved. By default <em>everysec</em> is enabled, which saves up and writes commands only once a second. This is a decent trade-off, since it’s fast enough, and worst case you’ll lose only the last one second of data. Finally, <em>no</em> is an option, which just lets the OS handle flushing. It can be fairly infrequent, and not recommended. <p><font color="#0000ff">appendfsync always</font> <p><font color="#0000ff"># appendfsync everysec</font> <p><font color="#0000ff"># appendfsync no</font> <p>From now on, every time Redis receives a command that changes the dataset (e.g. SET) it will append it to the AOF. When you restart Redis it will re-play the AOF to rebuild the state. Append-only has more detailed parameters, you could refer to the online documentation for more details. <h4>&nbsp;</h4> <h4>Security</h4> <p>Redis provides command-level security through obscurity, by allowing you to hide or suppress commands. This will rename the FLUSHALL command (remove all keys from the system) into some hard-to-guess value like c283d93ac9528f986023793b411e4ba2:</p> <p>rename-command FLUSHALL c283d93ac9528f986023793b411e4ba2</p> <p>If we attempt to execute FLUSHALL against this server, we’ll be hit with an error. We can also disable the command entirely by setting it to a blank string.</p> <p>rename-command FLUSHALL ""</p> <p>You can set any number of commands to a blank string to allow only a customized subset of the Redis’s commands.</p> <h4>Benchmarking</h4> <p>Redis provides an excellent benchmarking tool. It connects locally to port 6379 by default and issues 10,000 requests using 50 parallel clients. Tool test many commands and have a long output report. Tool is in C:\Program Files\Redis\</p> <p><a href="http://lh3.ggpht.com/-6I5RaONmt9E/UdMSNw-YfBI/AAAAAAAABo0/dTB6z-FLRv0/s1600-h/CWindowssystem32cmd.exe_2013-07-02_09-15-52%25255B3%25255D.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="CWindowssystem32cmd.exe_2013-07-02_09-15-52" border="0" alt="CWindowssystem32cmd.exe_2013-07-02_09-15-52" src="http://lh4.ggpht.com/-xzIRgQ4Gyvs/UdMSOX5rJMI/AAAAAAAABo8/ZM60jdO1mXY/CWindowssystem32cmd.exe_2013-07-02_09-15-52_thumb%25255B1%25255D.png?imgmax=800" width="342" height="366"></a></p> <h4>Replication</h4> <p>Redis supports master-slave replication. One server is the master by default if you don’t set it as a slave of anything. Data will be replicated to any number of slave servers. Configuring master-slave setting is the same as running another instance with the slaveof option in the salve’s conf file set to the master IP and port. Refer to our previous <a title="Running multiple Redis instances on the same server" href="http://ebeid-soliman.blogspot.com/2013/07/running-multiple-redis-instances-on.html" target="_blank">post</a> for more details.</p> <p>This concludes out Redis 101 tutorial, we tried to touch all basic and moderat
e features in it. Later we going to show how to write C# programs against Redis. </p>
